package tickMath

import (
	"math/big"
	"testing"
)

var (
	getSqrtRatioAtTickInputs = [...]int64{
		-4426934,
		-2594156,
		-5193191,
		-937338,
		5023291,
		-563109,
		8221603,
		6704642,
		4291419,
		-2731413,
		-613466,
		-478596,
		1128821,
		7132860,
		4683980,
		-1278189,
		6767825,
		264238,
		2688289,
		8265562,
	}

	getSqrtRatioAtTickOutputsStrings = [...]string{
		"704102482369438926462102",
		"1279718442622511059",
		"16196025",
		"351448071",
		"79287288518066660317860690653325349680018859711",
		"46960678200266877",
		"1098989465076666407055595944912184389053987135653",
		"74242227333659756689762681155325924661",
		"10176526784656539315567393789399",
		"1338953696751619",
		"3787046779917404",
		"3212322096292544658",
		"4378148616822743381155183155491",
		"147510119358387210288577590909591130988582882433",
		"3400377988712295911217826788129707177411",
		"818739837872639518208153",
		"1748170589774602425160684867219284498059",
		"43296020002723220051120964126940447",
		"542768537532503151875190798738442686449119",
		"1127985409318024713803043424744072176120762920413",
	}

	getTickAtSqrtRatioInputsStrings = [...]string{
		"1453307595472919455617204065685423346581090296651",
		"1253366006030963701028192554292325710120355164305",
		"848041822780204131353347584481729541414277062990",
		"1335344709074489154092336187984246178546961155545",
		"189964318199795839444690382865427686169778283855",
		"1324243769468097837310902853177167749488901613907",
		"1228573406243697365407589369799193204886930229709",
		"171633959934545846250298242348433349004177565906",
		"931726318066707770612844473046468110417281302347",
		"1235879074459700530429390056846970240329072970339",
		"922299647780975310755426093663400300171732151755",
		"355278970385610000213353829794126952317683457427",
		"863010139696156956761689372269691406058791647621",
		"1042849302993682434819611954709302497425247903002",
		"1099353957664670659937282391490080293632191483002",
		"220701008266987570220315932250588232082170288054",
		"1245439514657923601500135022017092924264839674324",
		"1439122357718129831501123110984692036721356525856",
		"766571580088247956696388160844258972513943383953",
		"125375333388094191587963815152414411209302010814",
	}

	getTickAtSqrtRatio = [...]int64{
		884691,
		879478,
		845505,
		874922,
		876079,
		868045,
		874430,
		886669,
		833430,
		885444,
		860279,
		834014,
		839778,
		863483,
		865336,
		868931,
		877399,
		885778,
		861017,
		868983,
	}
)

func init() {
	getTickAtSqrtRatioInputs = []*big.Int{}
	for _, input := range getTickAtSqrtRatioInputsStrings {
		getTickAtSqrtRatioInputs = append(getTickAtSqrtRatioInputs, new(big.Int).SetString(input, 10))
	}

	getSqrtRatioAtTickOutputs = []*big.Int{}
	for _, output := range getSqrtRatioAtTickOutputsStrings {
		getSqrtRatioAtTickOutputs = append(getSqrtRatioAtTickOutputs, new(big.Int).SetString(output, 10))
	}
}

func TestGetTickAtSqrtRatio(t *testing.T) {
	for i, input := range getTickAtSqrtRatioInputs {
		output := GetTickAtSqrtRatio(input)
		if output != getTickAtSqrtRatio[i] {
			t.Errorf("GetTickAtSqrtRatio(%s) = %d, want %d", input, output, getTickAtSqrtRatio[i])
		}
	}
}

func TestGetSqrtRatioAtTick(t *testing.T) {
	for i, input := range getSqrtRatioAtTickInputs {
		output := GetSqrtRatioAtTick(input)
		if output.Cmp(getSqrtRatioAtTickOutputs[i]) != 0 {
			t.Errorf("GetSqrtRatioAtTick(%d) = %s, want %s", input, output, getSqrtRatioAtTickOutputs[i])
		}
	}
}
